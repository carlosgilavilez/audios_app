const q=(function(){const o=function(e){return document.getElementById(e)},t=o("pl-audio");if(!t)return{bind:function(){},restore:function(){}};const v=o("sticky-player"),x=o("pl-play"),V=o("pl-play-icon"),J=o("pl-pause-icon"),_=o("pl-prev"),z=o("pl-next"),K=o("pl-back-10"),Q=o("pl-forward-10"),y=o("pl-title"),h=o("pl-author"),s=o("pl-seek"),L=o("pl-current"),U=o("pl-duration"),l=o("pl-volume"),k=o("pl-volume-toggle"),g=o("pl-rate"),f=o("pl-download"),b=document.getElementById("pl-expand"),W=b?b.querySelector("[data-player-toggle-label]"):null,m=window.matchMedia?window.matchMedia("(max-width: 767px)"):null;let C=!0,u=[],c=-1,A=!1,F=1;const j=()=>m?m.matches:(window.innerWidth||0)<=767,w=e=>{if(!v)return;const n=!!e;C=n,v.setAttribute("data-player-expanded",n?"true":"false"),b&&(b.setAttribute("aria-expanded",n?"true":"false"),W&&(W.textContent=n?"Ocultar controles":"Mostrar controles"))},M=()=>{j()&&!C&&w(!0)},$=()=>{j()?w(!1):w(!0)};if(m){const e=n=>{n.matches?w(!1):w(!0)};typeof m.addEventListener=="function"?m.addEventListener("change",e):typeof m.addListener=="function"&&m.addListener(e)}$();function I(e){if(!isFinite(e)||e<0)return"0:00";const n=Math.floor(e/60),i=Math.floor(e%60);return n+":"+(i<10?"0"+i:String(i))}function ee(e){return((e||"").toString().trim()||"audio").replace(/[\\/:*?"<>|]+/g,"").slice(0,60)||"audio"}function G(e,n){if(!f)return;const i=f.getAttribute("href")||n||"";i&&f.setAttribute("href",i);const a=i.split("?")[0].split(".").pop()||"mp3",r=a.length<=4?a:"mp3";f.setAttribute("download",ee(e)+"."+r)}function T(){v&&(v.classList.remove("hidden"),requestAnimationFrame(function(){v.classList.remove("opacity-0"),v.classList.remove("translate-y-2")}))}function d(e){V&&V.classList.toggle("hidden",e),J&&J.classList.toggle("hidden",!e),x&&(x.setAttribute("aria-label",e?"Pausar":"Reproducir"),x.setAttribute("aria-pressed",e?"true":"false"))}function N(){const e=document.querySelector('[data-wp-section]:not([hidden]) [data-view-active="true"]')||document.querySelector('[data-view-active="true"]');if(!e)return;e.querySelectorAll(".btn-play").forEach(function(i){i.classList.remove("bg-success","text-success-foreground"),i.classList.add("bg-card","text-success");const a=i.querySelector(".icon-play");a&&a.classList.remove("hidden");const r=i.querySelector(".icon-eq");r&&r.classList.add("hidden")})}function P(e){if(!e)return;e.classList.remove("bg-card","text-success"),e.classList.add("bg-success","text-success-foreground");const n=e.querySelector(".icon-play");n&&n.classList.add("hidden");const i=e.querySelector(".icon-eq");i&&i.classList.remove("hidden"),typeof e.focus=="function"&&e.focus({preventScroll:!0})}async function R(e){if(e<0||e>=u.length)return;c=e;const n=u[c];let i="",a="",r="",E="";if(window.audioPlaylist&&window.audioPlaylist[c]){const p=window.audioPlaylist[c];i=p.play_url||"",a=p.title||"",r=p.artist||"",E=p.download_url||""}else n&&(i=n.dataset.audioSrc||"",a=n.dataset.title||"",r=n.dataset.author||"",E=n.dataset.download||"");y&&(y.textContent=a||"-"),h&&(h.textContent=r||"-"),G(a,E||i),t.pause(),i&&(t.src=i,t.load()),N(),P(n),T(),M();try{await t.play(),d(!0)}catch(p){console.error("play()",p),d(!1)}}function D(){const e=document.querySelector('[data-wp-section]:not([hidden]) [data-view-active="true"]')||document.querySelector('[data-view-active="true"]')||document;u=Array.from(e.querySelectorAll(".btn-play[data-audio-src]")),u.forEach(function(n,i){n.dataset.index=i,n.dataset.playerBound!=="1"&&(n.dataset.playerBound="1",n.addEventListener("click",function(a){a.preventDefault();const r=n.dataset.audioSrc;if(r){if(t.src===r){t.paused?(c=i,N(),P(n),T(),M(),M(),t.play().then(function(){d(!0)}).catch(function(){})):t.pause();return}R(i)}}))})}function H(e){if(!isFinite(e))return;const n=isFinite(t.duration)?t.duration:0,i=isFinite(t.currentTime)?t.currentTime:0,a=Math.max(0,Math.min(n,i+e));t.currentTime=a,!A&&s&&(s.value=String(Math.floor(a))),L&&(L.textContent=I(a))}x&&x.addEventListener("click",function(){t.paused?t.play().then(function(){d(!0)}).catch(function(){}):(t.pause(),d(!1))}),_&&_.addEventListener("click",function(){c>0&&(D(),R(c-1))}),z&&z.addEventListener("click",function(){c<u.length-1&&(D(),R(c+1))}),b&&b.addEventListener("click",function(e){e.preventDefault(),w(!C)}),K&&K.addEventListener("click",function(){H(-10)}),Q&&Q.addEventListener("click",function(){H(10)}),t.addEventListener("loadedmetadata",function(){const e=Math.floor(t.duration||0);s&&(s.max=String(e)),U&&(U.textContent=I(e))}),t.addEventListener("timeupdate",function(){const e=Math.floor(t.currentTime||0);!A&&s&&(s.value=String(e)),L&&(L.textContent=I(e))});function B(){if(!s)return;const e=Number(s.value||0);isFinite(e)&&(t.currentTime=e),A=!1}s&&(s.addEventListener("input",function(){A=!0,L&&(L.textContent=I(Number(s.value)))}),s.addEventListener("change",B),s.addEventListener("mouseup",B),s.addEventListener("touchend",B,{passive:!0}));function O(){if(!k)return;const e=k.querySelector("i");e&&(t.muted||t.volume===0?e.setAttribute("data-lucide","volume-x"):t.volume<.5?e.setAttribute("data-lucide","volume-1"):e.setAttribute("data-lucide","volume-2"),window.lucide&&window.lucide.createIcons())}k&&k.addEventListener("click",function(){t.muted?(t.muted=!1,t.volume=F,l&&(l.value=String(F))):(F=t.volume,t.muted=!0,l&&(l.value="0")),O()}),l&&l.addEventListener("input",function(){const e=Number(l.value);isFinite(e)&&(t.volume=Math.max(0,Math.min(1,e)),t.muted=e===0),O()}),t.addEventListener("volumechange",O),g&&g.addEventListener("change",function(){const e=Number((g.value||"").replace("x",""));isFinite(e)&&e>0&&(t.playbackRate=e)}),t.addEventListener("ended",function(){d(!1),N()});function X(e){if(c<0||c>=u.length)return;const n=u[c],i=n.querySelector(".icon-eq");i&&i.classList.toggle("hidden",!e);const a=n.querySelector(".icon-play");a&&a.classList.toggle("hidden",e)}t.addEventListener("play",function(){d(!0),X(!0)}),t.addEventListener("pause",function(){d(!1),X(!1)});const Y="pl-state";let Z=0;function S(){try{const e={src:t.currentSrc||t.src||"",title:y&&y.textContent||"",author:h&&h.textContent||"",download:f&&f.getAttribute("href")||"",index:c,currentTime:Number(t.currentTime||0),paused:t.paused,volume:Number(t.volume||1),rate:Number(t.playbackRate||1)};localStorage.setItem(Y,JSON.stringify(e))}catch{}}t.addEventListener("timeupdate",function(){const e=Date.now();e-Z>1e3&&(Z=e,S())}),t.addEventListener("play",S),t.addEventListener("pause",S),window.addEventListener("beforeunload",S),document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&S()});async function te(){try{const e=localStorage.getItem(Y);if(!e)return;const n=JSON.parse(e);if(!n||!n.src)return;const i=Array.from(document.querySelectorAll(".btn-play[data-audio-src]")).find(function(r){return r.dataset.audioSrc===n.src});if(i?(u=Array.from(document.querySelectorAll(".btn-play[data-audio-src]")),c=Number(i.dataset.index||u.indexOf(i)),N(),P(i)):c=-1,y&&(y.textContent=n.title||"-"),h&&(h.textContent=n.author||"-"),f&&(f.href=n.download||n.src,G(n.title,n.download||n.src)),t.pause(),t.src=n.src,t.load(),T(),M(),isFinite(n.volume)){try{t.volume=Math.max(0,Math.min(1,Number(n.volume)))}catch{}l&&(l.value=String(t.volume))}if(isFinite(n.rate)&&n.rate>0){try{t.playbackRate=Number(n.rate)}catch{}if(g){const r=t.playbackRate+"x";Array.from(g.options||[]).some(function(p){return p.value===r})&&(g.value=r)}}const a=Number(n.currentTime||0);if(isFinite(a)&&a>0&&t.addEventListener("loadedmetadata",function r(){t.removeEventListener("loadedmetadata",r);try{t.currentTime=a}catch{}}),n.paused===!1)try{await t.play(),d(!0)}catch{}else d(!1)}catch{}}return{bind:D,restore:te}})();document.addEventListener("DOMContentLoaded",function(){if(!q||typeof q.bind!="function")return;q.bind(),!/^(?:\/admin|\/editor)\b/.test(location.pathname)&&typeof q.restore=="function"&&q.restore()});
